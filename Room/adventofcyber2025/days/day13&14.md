# ğŸ›¡ï¸ TryHackMe â€“ Advent of Cyber 2025

---

## Day 13 â€” YARA Rules: *YARA mean one!* ğŸ§¬

*Learning how YARA rules are used to detect malware and anomalies.*

**Platform:** TryHackMe  
**Duration:** 60 min  
**Status:** Completed (100%)

---

### â„ï¸ 1. Challenge Overview

**Focus:** Malware Detection & Threat Hunting  
**Objective:** Understand YARA rules, create detection logic, and hunt malicious artifacts using pattern matching.

---

### ğŸ§  2. What Is YARA?

YARA is a malware identification and classification tool used by defenders to detect threats based on patterns rather than file names.

**Common Use Cases:**

* Post-incident analysis
* Threat hunting
* Intelligence-driven scans
* Memory forensics
* IOC correlation

---

### ğŸ§© 3. YARA Rule Structure

A YARA rule consists of three main parts:

* **Meta:** Information about the rule (author, description, date)
* **Strings:** Patterns to search for (text, hex, regex)
* **Condition:** Logic that determines when a match occurs

**Example Rule:**

```yara
rule TBFC_KingMalhare_Trace
{
    meta:
        author = "Defender of SOC-mas"
        description = "Detects traces of King Malhareâ€™s malware"
        date = "2025-10-10"

    strings:
        $s1 = "rundll32.exe" fullword ascii
        $s2 = "msvcrt.dll" wide
        $url = /http:\/\/.*malhare.*/ nocase

    condition:
        any of them
}
```

---

### ğŸ§ª 4. YARA String Types

* **Text strings:** ASCII / Unicode  \
* **Hex strings:** Binary patterns  \
* **Regex strings:** Flexible pattern matching

**Common Modifiers:**

* `nocase` â€“ Case-insensitive
* `wide` / `ascii` â€“ Unicode & ASCII
* `xor` â€“ XOR-encoded strings
* `base64` / `base64wide` â€“ Base64-encoded data

---

### âš™ï¸ 5. Condition Logic

* Match one string: `$xmas`
* Match any string: `any of them`
* Match all strings: `all of them`
* Logical operators: `and`, `or`, `not`
* File checks: `filesize`, `entrypoint`

---

### ğŸ§ª 6. Practical Task â€” TBFC Message Hunt

**Goal:** Search images for strings starting with `TBFC:` using YARA.

---

### ğŸ§¾ 7. Task Question Answers

| Question                                                | Answer                   |
| ------------------------------------------------------- | ------------------------ |
| How many images contain the string TBFC?                | 5                        |
| Regex to match TBFC followed by alphanumeric characters | `/TBFC:[A-Za-z0-9]+/`    |
| Message sent by McSkidy                                 | Find me in HopSec Island |

---

### ğŸ›¡ï¸ 8. Blue Team Takeaways

* YARA enables proactive threat hunting
* Detects malware variants beyond static signatures
* Rules are shareable and customizable
* Essential tool for SOC and DFIR teams

âœ… **Day 13 completed â€” mastering YARA-based malware detection.**

---

## Day 14 â€” Containers: *DoorDasherâ€™s Demise* ğŸ³

*Exploring container security and Docker escape attacks.*

**Platform:** TryHackMe  
**Duration:** 60 min  
**Status:** Completed (100%)

---

### â„ï¸ 1. Challenge Overview

**Focus:** Container Security  
**Objective:** Understand containers, Docker architecture, and exploit a Docker socket misconfiguration to restore a defaced service.

---

### ğŸ§  2. Containers vs Virtual Machines

| Feature        | Containers         | Virtual Machines  |
| -------------- | ------------------ | ----------------- |
| OS Kernel      | Shared host kernel | Separate guest OS |
| Resource Usage | Lightweight        | Heavy             |
| Startup Speed  | Very fast          | Slower            |
| Isolation      | Process-level      | Full OS isolation |

---

### ğŸ§© 3. Key Concepts Covered

* Containerisation
* Docker Engine
* Dockerfiles
* Microservices
* Docker socket abuse
* Container escape attacks

---

### âš ï¸ 4. Container Escape via Docker Socket

If a container has access to `/var/run/docker.sock`, it can:

* Control the Docker daemon
* Spawn privileged containers
* Escape isolation and access the host

---

### ğŸ§ª 5. Practical Walkthrough Summary

* Enumerated running containers using Docker
* Accessed the `uptime-checker` container
* Discovered Docker socket access
* Escaped into a privileged `deployer` container
* Executed the recovery script
* Restored the defaced DoorDasher website

---

### ğŸ§¾ 6. Task Question Answers

| Question                                  | Answer                       |
| ----------------------------------------- | ---------------------------- |
| Command to list running Docker containers | `docker ps`                  |
| File used to build Docker images          | Dockerfile                   |
| Flag obtained                             | `THM{DOCKER_ESCAPE_SUCCESS}` |
| Bonus: Deployer user password             | `DeployMaster2025!`          |

---

### ğŸ›¡ï¸ 7. Blue Team Lessons

* Never expose Docker sockets to containers
* Apply least privilege to container runtimes
* Monitor for Docker API abuse
* Containers are **not** security boundaries by default

âœ… **Day 14 completed â€” understanding Docker security and container escapes.**

---

ğŸ„ **Advent of Cyber 2025 â€” Days 13 & 14 successfully completed.**
